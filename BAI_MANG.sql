CREATE TABLE KHOA
(
	MAKHOA VARCHAR(10) PRIMARY KEY,
	TENKHOA VARCHAR(10),
	DIENTHOAI VARCHAR(10)
)
GO
CREATE TABLE GIANGVIEN
(
	MAGV VARCHAR(10) PRIMARY KEY,
	HOTENGV VARCHAR(30),
	LUONG FLOAT,
	MAKHOA VARCHAR(10) REFERENCES KHOA(MAKHOA)
)
GO
CREATE TABLE SINHVIEN
(
	MASV VARCHAR(10) PRIMARY KEY,
	HOTENSV VARCHAR(30),
	MAKHOA VARCHAR(10) REFERENCES KHOA(MAKHOA),
	NAMSINH INT,
	QUEQUAN VARCHAR(10)
)
GO
CREATE TABLE DETAI
(
	MADT VARCHAR(10) PRIMARY KEY,
	TENDT VARCHAR(30),
	KINHPHI FLOAT,
	NOITHUCTAP VARCHAR(10)
)
GO
CREATE TABLE HUONGDAN
(
	MASV VARCHAR(10) PRIMARY KEY,
	MADT VARCHAR(10) REFERENCES DETAI(MADT),
	MAGV VARCHAR(10) REFERENCES GIANGVIEN(MAGV),
	KETQUA FLOAT
)

INSERT INTO KHOA VALUES
('K01','CNTT','0396434223'),
('K02','KINH TE','0394530944'),
('K03','MARKETING','0393101525'),
('K04','LUAT','0396434223'),
('K05','ENGLISH','0391977333')

INSERT INTO GIANGVIEN VALUES
('GV01','DANG YEN NHI',500,'K01'),
('GV02','PHAM THI THUY',350,'K01'),
('GV03','PHAM HONG NGA',440,'K02'),
('GV04','NGUYEN THI BINH',700,'K03'),
('GV05','DINH NGOC THAO MY',222,'K03'),
('GV06','TRAN VAN BINH',750,'K04'),
('GV07','DOAN THI PHUONG THANH',330,'K05')

INSERT INTO SINHVIEN VALUES
('SV01','TRAN MINH GIAP','K01',2004,'THAI BINH'),
('SV02','TRAN XUAN SON','K01',2004,'THAI BINH'),
('SV03','VU THI NGOC TRINH','K01',2004,'SAI GON'),
('SV04','TRAN VAN THU','K02',2004,'HA NOI'),
('SV05','PHAM THANH XUAN','K02',2004,'HA NOI'),
('SV06','DAO THANH TUYEN','K03',2004,'THAI BINH'),
('SV07','MAI HOANG ANH','K03',2004,'HA NOI'),
('SV08','PHAM PHUONG THAO','K04',2004,'HAN QUOC'),
('SV09','HOANG NGOC ANH','K05',2004,'HA NOI'),
('SV10','PHAM THI HUONG','K05',2004,'THAI BINH')


INSERT INTO DETAI VALUES
('DT01','PHAT TRIEN CONG NGHE PHAN MEM',1200,'HA NOI'),
('DT02','DU AN QUANG CAO SAN PHAM',15000,'HA LONG'),
('DT03','SUA DOI BO SUNG LUAT',1000,'HA NOI'),
('DT04','GIANG DAY TIENG ANH',7000,'HA NOI'),
('DT05','PHAT TRIEN CO SO HA TANG',9900,'THAI BINH'),
('DT06','LAP TRINH UNG DUNG',4500,'THAI BINH'),
('DT07','QUAN TRI DU LICH',950,'THANH HOA')

INSERT INTO HUONGDAN VALUES
('SV01','DT01','GV01',9.5),
('SV02','DT06','GV02',9.0),
('SV03','DT05','GV05',8.25),
('SV04','DT02','GV07',7.75),
('SV05','DT04','GV03',8.0),
('SV06','DT07','GV04',9.25),
('SV07','DT03','GV01',7.0),
('SV08','DT01','GV06',8.5),
('SV09','DT03','GV03',8.0)

-- 2 DUA RA THONG TIN CUA TAT CA GIANG VIEN 
SELECT * FROM GIANGVIEN

-- 3 DUA RA THONG TIN CUA GIANG VIEN THUOC KHOA CNTT VA MAKETING
SELECT * FROM GIANGVIEN,KHOA
WHERE GIANGVIEN.MAKHOA = KHOA.MAKHOA
AND TENKHOA IN ('CNTT','MARKETING')

-- 4 CHO BIET SO SINH VIEN THUOC KHOA CNTT
SELECT COUNT(*) AS SLUONG FROM SINHVIEN,KHOA
WHERE SINHVIEN.MAKHOA = KHOA.MAKHOA
AND TENKHOA = 'CNTT'

-- 5 CHO BIET THONG TIN DE TAI CO KINH PHI CAO NHAT 
SELECT * FROM DETAI
WHERE KINHPHI = (SELECT MAX(KINHPHI) FROM DETAI)
-- HOAC DUNG >= ALL

-- 6 CHO BIET THONG TIN KHONG THAM GIA THUC TAP
SELECT * FROM SINHVIEN
WHERE MASV NOT IN (SELECT MASV FROM HUONGDAN)

-- 7 DUA RA MA KHOA,TENKHOA,SO GIANG VIEN TUONG UNG VOI MOI KHOA
SELECT KHOA.MAKHOA,TENKHOA,COUNT(*) AS SOLUONG FROM KHOA,GIANGVIEN
WHERE KHOA.MAKHOA = GIANGVIEN.MAKHOA
GROUP BY KHOA.MAKHOA,TENKHOA

-- 8 CHO BIET SO DIEN THOAI CUA KHOA MA SINH VIEN TRAN XUAN XON THEO HOC
SELECT DIENTHOAI FROM KHOA,SINHVIEN
WHERE SINHVIEN.MAKHOA = KHOA.MAKHOA
AND HOTENSV = 'TRAN XUAN SON'

-- 9 CHO BIET MA VA TEN DE TAI DO GIANG VIEN DANG YEN NHI HUONG DAN !
SELECT DETAI.MADT,TENDT FROM GIANGVIEN,DETAI,HUONGDAN
WHERE GIANGVIEN.MAGV = HUONGDAN.MAGV
AND HUONGDAN.MADT = DETAI.MADT
AND HOTENGV = 'DANG YEN NHI'

-- 10 CHO BIET THONG TIN DE TAI KHONG CO SINH VIEIN NAO THUC TAP
SELECT * FROM DETAI
WHERE MADT NOT IN (SELECT MADT FROM HUONGDAN)

-- 11 CHO BIET MAGV , HOTENGV , TEN KHOA CUA GIANG VIEN CO HUONG DAN TU 2 SINH VIEN TRO LEN !
SELECT GIANGVIEN.MAGV,HOTENGV,COUNT(*) AS SL FROM HUONGDAN,GIANGVIEN
WHERE GIANGVIEN.MAGV = HUONGDAN.MAGV
GROUP BY GIANGVIEN.MAGV,HOTENGV
HAVING COUNT(*) >= 2

-- 12 CHO BIET MA , TEN DT CO KINH PHI CAO NHAT 
SELECT * FROM DETAI
WHERE KINHPHI >= ALL(SELECT KINHPHI FROM DETAI)

-- 13 CHO BIET MA SO VA TEN CAC DE TAI CO NHIEU HON 2 SINH VIEN THAM GIA THUC TAP !
SELECT DETAI.MADT,TENDT,COUNT(*) AS SL FROM HUONGDAN,DETAI
WHERE HUONGDAN.MADT = DETAI.MADT
GROUP BY DETAI.MADT,TENDT
HAVING COUNT(*) >= 2

-- 14 DUA RA MASV,HOTEN,DIEM CUA SINH VIEN KHOA CNTT VA MAKETING
SELECT SINHVIEN.MASV,HOTENSV,KETQUA FROM HUONGDAN,GIANGVIEN,KHOA,SINHVIEN
WHERE HUONGDAN.MAGV = GIANGVIEN.MAGV
AND GIANGVIEN.MAKHOA = KHOA.MAKHOA
AND SINHVIEN.MAKHOA = KHOA.MAKHOA
AND TENKHOA IN ('CNTT','MAKETING')

-- 15 TOAN CAU DE !


